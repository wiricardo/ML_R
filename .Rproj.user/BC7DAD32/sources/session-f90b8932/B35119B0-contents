---
title: "Final_R"
subtitle: "ML_Models"
---

# Librerias a utilizar

```{r}
#| message: false
#| warning: false
library(tidymodels)
library(tidyverse)
library(dplyr)
library(rio)
library(naniar)
```

# Importacion de datos

```{r}

data <- import('Mall_Customers_Enhanced.csv')

```

# EDA

## Visualizamos la data

```{r}
head(data)
```

## Exploramos las variables

```{r}
str(data)
```

## Seleccionamos nuestras variables y nos aseguramos de que no haya datos faltantes

-   Nuestra variable objetivo será "Credit Score"
-   Nuestras variables predictoras serán: "Annual Income", "Preferred Category" y "Estimated savings"

```{r}
data |> select(`Credit Score`, `Annual Income (k$)`, `Preferred Category`, `Estimated Savings (k$)`) |> 
  filter(is.na(`Credit Score`))
```

## Revisamos que tampoco haya datos faltantes en nuetra variable objetivo (**Credit Score**)

```{r}
data |> filter(is.na(`Credit Score`))
```

## Ultima verificacion de datos faltantes

```{r}
data |> vis_miss()
```

## Exploramos las variables que escogimos

```{r}

est_vars <- summary(data |> select(`Credit Score`, `Annual Income (k$)`, `Preferred Category`, `Estimated Savings (k$)`) |> 
  as_tibble(rownames = 'Estadístico'))

est_vars


```

Notamos que podemos normalizar algunas variables y convertir a variables dummy la variable categgeorica

# Prepamos la data antes de definir el modelo de regresión lineal

## Split de la data

```{r}

ds_split <- initial_split(data)
training_data <- training(ds_split)
testing_data <- testing(ds_split)
```

## Procesamiento de los datos

Creamos las *recetas*

-   Receta 1: Usamos solo **Annual Income (k\$)** como predictor

```{r}
receta_1 <- recipe(`Credit Score` ~ `Annual Income (k$)`, data = training_data) |> 
  step_normalize(`Annual Income (k$)`)
```

-   Receta 2: Usamos  **Annual Income (k\$)** y **Estimated Savings (k$)** y como predictores
